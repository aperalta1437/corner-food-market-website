-- CUSTOMER ---------------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_CUSTOMER() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON CUSTOMER
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_CUSTOMER();

-- DELIVERY_ADDRESS ------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_DELIVERY_ADDRESS() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON DELIVERY_ADDRESS
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_DELIVERY_ADDRESS();

-- ITEM_CATEGORY --------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_ITEM_CATEGORY() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON ITEM_CATEGORY
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_ITEM_CATEGORY();

-- ITEM_INVENTORY --------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_ITEM_INVENTORY() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON ITEM_INVENTORY
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_ITEM_INVENTORY();


-- ITEM ----------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_ITEM() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON ITEM
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_ITEM();


-- ITEM_IMAGE ----------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_ITEM_IMAGE() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON ITEM_IMAGE
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_ITEM_IMAGE();


CREATE OR REPLACE FUNCTION set_FILE_NAME_for_ITEM_IMAGE() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.FILE_NAME = CONCAT(CAST(NEW.FILE_NAME_PREFIX AS VARCHAR), '.', NEW.FILE_EXTENSION);
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_FILE_NAME_on_before_INSERT
BEFORE INSERT ON ITEM_IMAGE
FOR EACH ROW
EXECUTE PROCEDURE set_FILE_NAME_for_ITEM_IMAGE();


-- GENERAL_REVIEW ----------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_GENERAL_REVIEW() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON GENERAL_REVIEW
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_GENERAL_REVIEW();


-- CART_ITEM ----------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_CART_ITEM() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON CART_ITEM
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_CART_ITEM();


-- ADMINISTRATOR ---------------------------------------------------------------------------------------

CREATE OR REPLACE FUNCTION set_CREATED_AT_for_ADMINISTRATOR() RETURNS TRIGGER AS $BODY$
BEGIN
    NEW.CREATED_AT = now();
    RETURN NEW;
END; $BODY$
LANGUAGE plpgsql;

CREATE TRIGGER set_CREATED_AT_on_before_INSERT
BEFORE INSERT ON ADMINISTRATOR
FOR EACH ROW
EXECUTE PROCEDURE set_CREATED_AT_for_ADMINISTRATOR();







--CREATE OR REPLACE FUNCTION set_CREATED_AT_for_CUSTOMER() RETURNS TRIGGER AS $$
--BEGIN
--    UPDATE  CUSTOMER
--    SET     CREATED_AT = now()
--    WHERE   ID = NEW.ID;
--
--    RETURN NEW;
--END; $$
--LANGUAGE plpgsql;
--
--CREATE TRIGGER set_CREATED_AT_on_after_INSERT
--AFTER INSERT ON CUSTOMER
--FOR EACH ROW
--EXECUTE PROCEDURE set_CREATED_AT_for_CUSTOMER();